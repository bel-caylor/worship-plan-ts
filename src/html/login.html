<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Login</title>
  <style>
    body { font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif; margin:0; padding:1rem; background:#f3f4f6; }
    .panel { background:white; border-radius:8px; padding:1.5rem; box-shadow:0 20px 50px rgba(15,23,42,.15); }
    .status { margin-top:1rem; font-size:.9rem; color:#111827; }
  </style>
</head>
<body>
  <div class="panel">
    <h1 style="margin:0 0 .5rem;">Authenticatingâ€¦</h1>
    <p class="status" id="status">Please wait while we sign you in with Google.</p>
  </div>
  <script>
    const sendToken = (token) => {
      if (window.opener && token) {
        window.opener.postMessage({ type: 'auth-token', token }, '*');
      }
      try { window.close(); } catch (_){}
    };
    const reportError = (err) => {
      const statusEl = document.getElementById('status');
      if (statusEl) statusEl.textContent = 'Login failed. Please close and try again.';
      console.error(err);
    };
    google.script.run
      .withSuccessHandler(sendToken)
      .withFailureHandler(reportError)
      .issueAuthToken();
  </script>
</body>
</html>
