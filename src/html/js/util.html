<script>
  function callRpc(method, payload) {
    return new Promise((resolve, reject) => {
      const run = (window.google && google.script && google.script.run) || null;
      if (!run) return reject(new Error('Apps Script client not ready'));
      run.withSuccessHandler(resolve).withFailureHandler(reject).rpc({ method, payload });
    });
  }
</script>
