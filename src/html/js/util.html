<script>
  function callRpc(method, payload) {
    return new Promise((resolve, reject) => {
      if (!(window.google && google.script && google.script.run)) {
        return reject(new Error('Apps Script client not ready'));
      }
      google.script.run
        .withSuccessHandler(resolve)
        .withFailureHandler(reject)
        .rpc({ method, payload }); // single, stable entrypoint
    });
  }
</script>
